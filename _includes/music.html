<!-- APlayer -->
<!-- <link rel="stylesheet" href="https://unpkg.com/aplayer/dist/APlayer.min.css">
<script src="https://unpkg.com/aplayer/dist/APlayer.min.js"></script>

<style>
  /* æ‚¬æµ®æŒ‰é’® */
  #music-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 42px;
    height: 42px;
    background: rgba(255,255,255,0.8);
    border-radius: 50%;
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 99999;
    font-size: 20px;
  }
  #music-btn:hover {
    background: rgba(255,255,255,1);
  }

  /* æ’­æ”¾å™¨å®¹å™¨ */
  #player-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 99998;
  }
</style> -->

<!-- æ‚¬æµ®æŒ‰é’® + æ’­æ”¾å™¨å®¹å™¨ -->
<!-- <div id="music-btn">ğŸµ</div>
<div id="player-bar"></div>

<script>
  const btn = document.getElementById('music-btn');
  const bar = document.getElementById('player-bar');

  // ç‚¹å‡»æŒ‰é’®æ˜¾ç¤º/éšè—æ’­æ”¾å™¨
  btn.onclick = function() {
    if(bar.style.display === "none" || !bar.style.display) {
      bar.style.display = "block";
    } else {
      bar.style.display = "none";
    }
  };

  // è¯»å– music-data.json å¹¶åˆå§‹åŒ– APlayer
  fetch("{{ '/assets/music/music-data.json' | relative_url }}")
    .then(res => res.json())
    .then(data => {
      const musicList = data.map(item => ({
        name: item.name && item.name.trim() ? item.name : "æœªçŸ¥",
        artist: item.artist && item.artist.trim() ? item.artist : "æœªçŸ¥",
        url: "{{ '/assets/music/' | relative_url }}" + item.file,
        cover: "{{ '/assets/music/cover/' | relative_url }}" + (item.cover && item.cover.trim() ? item.cover : "cover.jpg")
      }));

      // åˆå§‹åŒ– APlayer
      const ap = new APlayer({
        container: document.getElementById('player-bar'),
        fixed: true,          // å›ºå®šåº•éƒ¨
        audio: musicList,
        listFolded: false,
        order: 'list',
        autoplay: false,
        preload: 'auto'
      });
    });
</script> -->



<!-- APlayer -->
<link rel="stylesheet" href="https://unpkg.com/aplayer/dist/APlayer.min.css">
<script src="https://unpkg.com/aplayer/dist/APlayer.min.js"></script>

<style>
  #music-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 42px;
    height: 42px;
    background: rgba(255,255,255,0.8);
    border-radius: 50%;
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 9999;
    font-size: 20px;
  }
  #music-btn:hover {
    background: rgba(255,255,255,1);
  }
  #player-bar {
    position: fixed;
    bottom: -100px;
    left: 0;
    width: 100%;
    transition: 0.35s ease;
    z-index: 9998;
  }
  #player-bar.show {
    bottom: 0;
  }
</style>

<!-- æ‚¬æµ®æŒ‰é’® + æ’­æ”¾å™¨å®¹å™¨ -->
<div id="music-btn">ğŸµ</div>
<div id="player-bar"></div>

<script>
  /* è‡ªåŠ¨æ‰«æ /assets/music/ ç›®å½•çš„æ‰€æœ‰éŸ³ä¹æ–‡ä»¶ */
  const musicList = [
    {% assign music_files = site.static_files | where_exp:"file","file.path contains 'assets/music'" %}
    {% for file in music_files %}
      {% if file.extname == ".mp3" or file.extname == ".wav" or file.extname == ".ogg" %}
      {
        name: "{{ file.basename }}",
        artist: "æœªçŸ¥",
        url: "{{ file.path | relative_url }}",
        cover: "{{ '/assets/music/cover.jpg' | relative_url }}"
      }{% unless forloop.last %},{% endunless %}
      {% endif %}
    {% endfor %}
  ];

  /* åˆå§‹åŒ–æ’­æ”¾å™¨ */
  const ap = new APlayer({
    container: document.getElementById('player-bar'),
    fixed: true,
    audio: musicList
  });

  /* ç‚¹å‡»å›¾æ ‡å±•å¼€/æ”¶èµ·æ’­æ”¾å™¨ */
  const btn = document.getElementById('music-btn');
  const bar = document.getElementById('player-bar');

  btn.onclick = function () {
    bar.classList.toggle('show');
  };
</script>
