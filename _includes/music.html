<!-- APlayer -->
<link rel="stylesheet" href="https://unpkg.com/aplayer/dist/APlayer.min.css">
<script src="https://unpkg.com/aplayer/dist/APlayer.min.js"></script>

<style>
  #music-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 42px;
    height: 42px;
    background: rgba(255,255,255,0.8);
    border-radius: 50%;
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 9999;
    font-size: 20px;
  }
  #music-btn:hover {
    background: rgba(255,255,255,1);
  }
  #player-bar {
    position: fixed;
    bottom: -100px;
    left: 0;
    width: 100%;
    transition: 0.35s ease;
    z-index: 9998;
  }
  #player-bar.show {
    bottom: 0;
  }
</style>

<!-- æ‚¬æµ®æŒ‰é’® + æ’­æ”¾å™¨å®¹å™¨ -->
<div id="music-btn">ğŸµ</div>
<div id="player-bar"></div>

<script>
    // è¯»å– music-data.json å¹¶åˆå§‹åŒ– APlayer
  fetch("{{ '/assets/music/music-data.json' | relative_url }}")
    .then(res => res.json())
    .then(data => {
      const musicList = data.map(item => ({
        name: item.name && item.name.trim() ? item.name : "æœªçŸ¥",
        artist: item.artist && item.artist.trim() ? item.artist : "æœªçŸ¥",
        url: "{{ '/assets/music/' | relative_url }}" + item.file,
        cover: "{{ '/assets/music/cover/' | relative_url }}" + (item.cover && item.cover.trim() ? item.cover : "cover.jpg")
      }));

      // åˆå§‹åŒ– APlayer
      const ap = new APlayer({
        container: document.getElementById('player-bar'),
        fixed: true,          // å›ºå®šåº•éƒ¨
        audio: musicList,
        listFolded: false,
        order: 'list',
        autoplay: false,
        preload: 'auto'
      });
  });

  /* ç‚¹å‡»å›¾æ ‡å±•å¼€/æ”¶èµ·æ’­æ”¾å™¨ */
  const btn = document.getElementById('music-btn');
  const bar = document.getElementById('player-bar');

  btn.onclick = function () {
    bar.classList.toggle('show');
  };
</script>
